{% load static %}
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Responsivo</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{% static 'css/tag_buttons.css' %}">
</head>
<body>
    <div class="sidebar" id="sidebar">
        <button class="toggle-btn" id="toggleBtn">
            <i class="fas fa-chevron-left"></i>
        </button>

        <div class="profile">
            <h2>Click32</h2>            
        </div>

        <!--<input type="text" class="search-bar" placeholder="Search...">-->

        <ul class="menu">
            {% for group, tags in tag_groups.items %}
                <li class="menu-item">
                    <div class="menu-header">
                        <i class="fas {% if group == 'Comidas' %}fa-utensils
                                     {% elif group == 'Comércios' %}fa-store
                                     {% elif group == 'Serviços' %}fa-tools
                                     {% elif group == 'Beleza' %}fa-spa
                                     {% elif group == 'Saúde' %}fa-heartbeat
                                     {% elif group == 'Educação' %}fa-graduation-cap
                                     {% elif group == 'Outros' %}fa-th
                                     {% else  %}fa-th{% endif %}"></i>
                        <span class="menu-text">{{ group }}</span>
                        
                    </div>
                    <ul class="dropdown" style="display: none;">
                        {% for tag in tags %}
                            <li>
                                <a href="?tag={{ tag }}" class="dropdown-item">{{ tag }}</a>
                            </li>
                        {% endfor %}
                    </ul>
                </li>
            {% endfor %}
        </ul>
    </div>

 <script>
    // Toggle sidebar
    const sidebar = document.getElementById('sidebar');
    const toggleBtn = document.getElementById('toggleBtn');

    toggleBtn.addEventListener('click', () => {
        sidebar.classList.toggle('collapsed');
        toggleBtn.innerHTML = sidebar.classList.contains('collapsed')
            ? '<i class="fas fa-chevron-right"></i>'
            : '<i class="fas fa-chevron-left"></i>';
    });

    // Toggle dropdown
    document.querySelectorAll('.menu-header').forEach(header => {
        header.addEventListener('click', (e) => {
            e.preventDefault();
            const dropdown = header.nextElementSibling;
            const isOpen = dropdown.classList.contains('open');
            console.log('Clicou em:', header.textContent, 'Dropdown:', dropdown, 'Itens:', dropdown.children.length, 'Aberto:', isOpen);

            // Fechar todos os dropdowns
            document.querySelectorAll('.dropdown').forEach(d => {
                d.classList.remove('open');
            });

            // Alternar o dropdown atual
            if (!isOpen) {
                dropdown.classList.add('open');
            }
        });
    });

    // Close dropdown when clicking a tag
    document.querySelectorAll('.dropdown-item').forEach(item => {
        item.addEventListener('click', (e) => {
            document.querySelectorAll('.dropdown').forEach(d => {
                d.classList.remove('open');
            });
        });
    });

    // Handle clicks outside sidebar on mobile
    document.addEventListener('click', (e) => {
        if (window.innerWidth <= 768 &&
            !sidebar.contains(e.target) &&
            e.target !== toggleBtn &&
            !sidebar.classList.contains('collapsed') &&
            !e.target.closest('.dropdown')) {
            sidebar.classList.add('collapsed');
            toggleBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
        }
    });
</script>
</body>
</html>